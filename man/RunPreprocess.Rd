% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Report_function.R
\name{RunPreprocess}
\alias{RunPreprocess}
\title{Run Preprocessing Pipeline for Single-Cell Data}
\usage{
RunPreprocess(
  object,
  sample.by = "orig.ident",
  db.method = c("scDblFinder", "hybrid"),
  lq.method = c("MAD"),
  preprocess = "rna.umap",
  ...
)
}
\arguments{
\item{object}{A Seurat object containing single-cell RNA-seq data.}

\item{sample.by}{A character string specifying the column in the metadata that identifies different samples or batches. Default is \code{"orig.ident"}.}

\item{db.method}{A character vector specifying the method(s) to use for doublet detection. Options include \code{"scDblFinder"}. Default is \code{"scDblFinder"}.}

\item{lq.method}{A character vector specifying the method(s) to use for low-quality cell filtering. Options include \code{"MAD"}. Default is \code{"MAD"}.}

\item{preprocess}{The method of preprocessing and clustering to use. Options include:
\itemize{
\item "rna.pca": Perform the analysis to PCA step on RNA assay.
\item "rna.umap": Perform the analysis to UMAP step on RNA assay.
\item "rna.umap.har": Perform the analysis to UMAP step on RNA assay with Harmony integration.
\item "adt.pca": Perform the analysis to PCA step on ADT assay.
\item "adt.umap": Perform the analysis to UMAP step on ADT assay.
\item "adt.umap.har": Perform the analysis to UMAP step on ADT assay with Harmony integration.
\item "wnn.umap": Perform the analysis to UMAP step using weighted nearest neighbor (WNN) method on RNA+ADT assays.
\item "wnn.umap.har": Perform the analysis to UMAP step using weighted nearest neighbor (WNN) method on RNA+ADT assays with Harmony integration.
}
The default setting: "rna.umap".}

\item{...}{Additional arguments to be passed to \code{`RunPipeline`} function.}
}
\value{
A Seurat object with the following updates:
\itemize{
\item Quality metrics added to the metadata.
\item Cell type annotations added to the metadata.
\item Doublet scores and classifications added to the metadata.
\item Low-quality cell classifications added to the metadata.
\item Dimensionality reduction results (e.g., UMAP) added to the object.
}
}
\description{
This function runs a comprehensive preprocessing pipeline for single-cell RNA-seq data. It includes steps for calculating quality metrics, cell type annotation, doublet detection, low-quality cell filtering, and dimensionality reduction (e.g., UMAP). The function is designed to work with Seurat objects and supports customization of doublet detection and low-quality cell filtering methods.
}
\details{
The function performs the following steps:
\enumerate{
\item \strong{Calculate Quality Metrics}: Adds quality metrics (e.g., number of genes, mitochondrial percentage) to the metadata.
\item \strong{Cell Type Annotation}: Runs cell type annotation using the \code{RunScType} function.
\item \strong{Doublet Detection}: Detects doublets using the specified method(s) (e.g., \code{scDblFinder}).
\item \strong{Low-Quality Cell Detection}: Filters low-quality cells using the specified method(s) (e.g., \code{MAD}).
\item \strong{Dimensionality Reduction}: Runs a preprocessing pipeline (e.g., UMAP) for visualization and downstream analysis.
}
}
\examples{
\dontrun{
# Load a Seurat object
data("pbmc_small", package = "Seurat")

# Run the preprocessing pipeline
pbmc_small <- RunPreprocess(pbmc_small, sample.by = "orig.ident")

# View the updated Seurat object
print(pbmc_small)
}

}
