% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Sample_QC.R
\name{FindInterSamplePCTOutlier}
\alias{FindInterSamplePCTOutlier}
\title{Find Inter-Sample Cell Type Proportion Outliers}
\usage{
FindInterSamplePCTOutlier(
  object,
  sample.by = "orig.ident",
  celltype.by = "ScType",
  split.by = NULL,
  color.pca = NULL,
  color.bar = "#56B4E9",
  confidence_level = 0.95,
  labelOnlyOutlier = T,
  minPts = 3,
  method = "ellipse",
  top = Inf,
  return.type = c("table"),
  verbose = TRUE
)
}
\arguments{
\item{object}{A Seurat object or a data frame. If a Seurat object is provided, the metadata will be extracted. If a data frame is provided, it should contain the necessary columns for sample and cell type information.}

\item{sample.by}{A character string specifying the metadata column that identifies samples. Default: \code{"orig.ident"}.}

\item{celltype.by}{A character string specifying the metadata column that contains cell type information. Default: \code{"ScType"}.}

\item{split.by}{A character string specifying an optional metadata column to split the analysis by. Default: \code{NULL}.}

\item{color.pca}{A character vector specifying the colors to use for the PCA plot. If \code{NULL}, default colors will be used. Default: \code{NULL}.}

\item{color.bar}{A character string specifying the color to use for the bar plot. Default: \code{"#56B4E9"}.}

\item{confidence_level}{A numeric value specifying the confidence level for outlier detection (e.g., \code{0.95} for 95\% confidence interval). Default: \code{0.95}.}

\item{labelOnlyOutlier}{A logical value specifying whether to label only the outlier samples in the PCA plot. Default: \code{TRUE}.}

\item{minPts}{An integer specifying the minimum number of points required to form a cluster in DBSCAN. Default: \code{3}.}

\item{method}{A character string specifying the method for outlier detection. Supported methods include:
\itemize{
\item \code{"ellipse"}: Use Euclidean distance for PCA-based outlier detection.
\item \code{"dbscan"}: Use DBSCAN for density-based outlier detection.
Default: \code{"ellipse"}.
}}

\item{top}{An integer specifying the number of top principal components to display in the contribution plots. Default: \code{Inf} (all components).}

\item{return.type}{A character vector specifying the type of output to return. Supported values include:
\itemize{
\item \code{"table"}: Return a table of outlier results.
\item \code{"plot"}: Return a plot of outlier results.
\item \code{"interactive_table"}: Return an interactive table of outlier results.
Default: \code{"table"}.
}}

\item{verbose}{A logical value. If \code{TRUE} (default), the message will be printed.
If \code{FALSE} , the message will be suppressed (not printed).}
}
\value{
A list containing the following components based on the \code{return.type} parameter:
\itemize{
\item If \code{"table"} is specified: A list with two elements:
\itemize{
\item \code{outlier}: A data frame containing the outlier detection results.
\item \code{contribution}: A data frame containing the contribution of each cell type to the principal components.
}
\item If \code{"plot"} is specified: A list with four elements:
\itemize{
\item \code{pca}: A ggplot object showing the PCA plot with outliers labeled.
\item \code{contrib_pc1}: A ggplot object showing the contribution of cell types to PC1.
\item \code{contrib_pc2}: A ggplot object showing the contribution of cell types to PC2.
\item \code{contrib_pc1_2}: A ggplot object showing the combined contribution of cell types to PC1 and PC2.
}
\item If \code{"interactive_table"} is specified: A list with two elements:
\itemize{
\item \code{outlier}: An interactive table of outlier results.
\item \code{contribution}: An interactive table of cell type contributions to the principal components.
}
}
}
\description{
This function detects outliers in cell type composition across samples using PCA (Principal Component Analysis) and DBSCAN (Density-Based Spatial Clustering of Applications with Noise). It can be applied to a Seurat object or a data frame containing sample and cell type metadata.
}
\seealso{
\link{RunScType} for cell type annotation.
}
