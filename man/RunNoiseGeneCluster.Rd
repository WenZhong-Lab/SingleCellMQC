% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Genelist_Benchmark.R
\name{RunNoiseGeneCluster}
\alias{RunNoiseGeneCluster}
\title{Run Noise Gene Clustering Benchmark}
\usage{
RunNoiseGeneCluster(
  object,
  gene_list = NULL,
  nfeatures = 2000,
  har.batch.by,
  resolution = c(1, 2),
  tmpdir = "./temp_SingleCellMQC/BenchmarkDelGene/"
)
}
\arguments{
\item{object}{A single-cell object (e.g., Seurat object) from which
expression data and metadata will be extracted.}

\item{gene_list}{(Optional) A named list of character vectors, where each
vector contains gene names considered as a specific type of "noise" (e.g.,
\code{list(mt = c("MT-G1", "MT-G2"))}). If \code{NULL}, \code{GetNoiseGeneList} is used
to define common noise gene sets.}

\item{nfeatures}{An integer specifying the number of highly variable features
to use for PCA. Defaults to 2000.}

\item{har.batch.by}{A character string or vector specifying the metadata
columns to use for batch correction with Harmony.}

\item{resolution}{A numeric vector of resolution values for Leiden clustering.
Defaults to \code{c(1, 2)}.}

\item{tmpdir}{A character string specifying a temporary directory for large
intermediate files (particularly from \code{BPCells}). Defaults to
"./temp_SingleCellMQC/BenchmarkDelGene/".}
}
\value{
A named list of data frames. Each element in the list corresponds
to a clustering \code{resolution} (e.g., \code{resolution=1}, \code{resolution=2}).
Each data frame contains clustering assignments for each cell, with columns
like 'del_all' (clustering after removing all noise genes) and 'add_X'
(clustering after removing all noise genes and then adding back noise set X).
}
\description{
This function performs a benchmark to evaluate the impact of removing different
sets of "noise" genes (e.g., mitochondrial, ribosomal, dissociation-induced)
on the clustering of single-cell RNA-seq data. It compares clustering results
after removing all noise genes versus removing all noise genes but then adding
back specific subsets.
}
\details{
The function first defines or takes specific noise gene sets. It then performs
the following steps:
\enumerate{
\item \strong{"Del All" Baseline}: Runs PCA and Harmony (for batch correction) after
excluding \emph{all} genes specified in the combined \code{gene_list}. Clustering
is then performed.
\item \strong{"Add Back" Scenarios}: For each individual noise gene set in \code{gene_list},
it repeats the PCA and Harmony process, but this time, after excluding
all noise genes, it \emph{adds back} the genes from the current specific noise set.
Clustering is then performed.
All PCA, Harmony, and clustering steps are performed with fixed random seeds
for reproducibility across comparisons.
}
}
\seealso{
\code{\link{GetNoiseGeneList}}.
}
