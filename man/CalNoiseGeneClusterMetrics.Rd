% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Genelist_Benchmark.R
\name{CalNoiseGeneClusterMetrics}
\alias{CalNoiseGeneClusterMetrics}
\title{Calculate Noise Gene Cluster Metrics}
\usage{
CalNoiseGeneClusterMetrics(object, cluster_info)
}
\arguments{
\item{object}{A single-cell object (e.g., Seurat object) from which
expression data and metadata will be extracted for Gini calculations.}

\item{cluster_info}{A data frame or a named list of data frames containing
clustering results, typically the output of \code{RunNoiseGeneCluster}.
Each data frame should have columns 'del_all' and 'add_X' for different
noise gene removal scenarios.}
}
\value{
If \code{cluster_info} is a single data frame, returns a list with:
\itemize{
\item \code{Variance_fractions}: A data frame summarizing the variance
explained by clusterings for various metadata features (e.g., \%MT, \%RB, inferred cell cycle, dissociation genes).
\item \code{Diff_Gini}: A data frame summarizing the differences in Gini
coefficients for specific marker genes across 'add_X' vs 'del_all' scenarios.
}
If \code{cluster_info} is a list (e.g., for different resolutions), returns
a named list of such lists, where names correspond to the resolutions.
}
\description{
This function calculates various metrics to evaluate the impact of noise
gene removal strategies on clustering and metadata variable associations.
It computes variance fractions explained by \code{del_all} and \code{add_X} clusterings,
and differences in Gini coefficients for relevant genes.
}
\details{
The function uses two main types of metrics:
\enumerate{
\item \strong{Variance Fractions}: For each metadata variable (e.g., percent.mt, percent.rb),
it fits a mixed-effects model using \code{lmerTest::lmer} and
\code{variancePartition::calcVarPart} to calculate the fraction of variance
explained by the noise-aware clusterings
(\code{del_all}, \code{add_X}). \code{calMetadataVarPart} (an internal helper) is used for this.
\item \strong{Gini Coefficient Differences}: For specific marker genes (e.g., from TCR, BCR, sex chromosomes),
it calculates the Gini coefficient
for gene expression proportion (pct) across clusters for both \code{del_all} and \code{add_X} scenarios.
The differences (add_X - del_all) are then reported, indicating if adding back
certain noise genes worsens the localized expression proportion of these markers.
}
}
